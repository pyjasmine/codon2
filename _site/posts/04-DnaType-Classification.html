<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Jasmine Marzouk – dnatype-classification</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Jasmine Marzouk</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pyjasmine"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="dnatype-classification" class="level1">
<h1>DNAtype Classification</h1>
<section id="plan-for-modeling" class="level2">
<h2 class="anchored" data-anchor-id="plan-for-modeling">Plan for Modeling:</h2>
<p>With modeling I will start with a Logistic Regression</p>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># imports</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> plot_importance</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_auc_score</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> MultiIndex, Int16Dtype</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBClassifier</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> StackingClassifier</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, plot_tree</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler, StandardScaler</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> (GridSearchCV, cross_val_score,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                                     train_test_split)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> (accuracy_score, auc, classification_report,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                             confusion_matrix, f1_score, plot_confusion_matrix,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>                             plot_roc_curve, precision_score, recall_score,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                             roc_auc_score, roc_curve)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> TSNE</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_blobs</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> DBSCAN</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> hstack, unique, vstack, where</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> joblib</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co"># warnings.filterwarnings("ignore")</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="plan-for-modelling" class="level1">
<h1>Plan for Modelling:</h1>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># you can find this image in the zip folder</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Image(<span class="st">'../notebooks/modelling_plan.png'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># change the path accordingly.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<p><img src="04-DnaType-Classification_files/figure-html/cell-3-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import the data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>codon <span class="op">=</span> joblib.load(<span class="st">'../data/codon_after_eda.pkl'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"darkgrid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>codon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Kingdom</th>
      <th>DNAtype</th>
      <th>SpeciesID</th>
      <th>Ncodons</th>
      <th>SpeciesName</th>
      <th>UUU</th>
      <th>UUC</th>
      <th>UUA</th>
      <th>UUG</th>
      <th>CUU</th>
      <th>...</th>
      <th>CGG</th>
      <th>AGA</th>
      <th>AGG</th>
      <th>GAU</th>
      <th>GAC</th>
      <th>GAA</th>
      <th>GAG</th>
      <th>UAA</th>
      <th>UAG</th>
      <th>UGA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>virus</td>
      <td>0</td>
      <td>100217</td>
      <td>7.598900</td>
      <td>Epizootic haematopoietic necrosis virus</td>
      <td>0.01654</td>
      <td>0.01203</td>
      <td>0.00050</td>
      <td>0.00351</td>
      <td>0.01203</td>
      <td>...</td>
      <td>0.00451</td>
      <td>0.01303</td>
      <td>0.03559</td>
      <td>0.01003</td>
      <td>0.04612</td>
      <td>0.01203</td>
      <td>0.04361</td>
      <td>0.00251</td>
      <td>0.00050</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>virus</td>
      <td>0</td>
      <td>100220</td>
      <td>7.296413</td>
      <td>Bohle iridovirus</td>
      <td>0.02714</td>
      <td>0.01357</td>
      <td>0.00068</td>
      <td>0.00678</td>
      <td>0.00407</td>
      <td>...</td>
      <td>0.00136</td>
      <td>0.01696</td>
      <td>0.03596</td>
      <td>0.01221</td>
      <td>0.04545</td>
      <td>0.01560</td>
      <td>0.04410</td>
      <td>0.00271</td>
      <td>0.00068</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>virus</td>
      <td>0</td>
      <td>100755</td>
      <td>8.489411</td>
      <td>Sweet potato leaf curl virus</td>
      <td>0.01974</td>
      <td>0.02180</td>
      <td>0.01357</td>
      <td>0.01543</td>
      <td>0.00782</td>
      <td>...</td>
      <td>0.00596</td>
      <td>0.01974</td>
      <td>0.02489</td>
      <td>0.03126</td>
      <td>0.02036</td>
      <td>0.02242</td>
      <td>0.02468</td>
      <td>0.00391</td>
      <td>0.00000</td>
      <td>0.00144</td>
    </tr>
    <tr>
      <th>3</th>
      <td>virus</td>
      <td>0</td>
      <td>100880</td>
      <td>7.557995</td>
      <td>Northern cereal mosaic virus</td>
      <td>0.01775</td>
      <td>0.02245</td>
      <td>0.01619</td>
      <td>0.00992</td>
      <td>0.01567</td>
      <td>...</td>
      <td>0.00366</td>
      <td>0.01410</td>
      <td>0.01671</td>
      <td>0.03760</td>
      <td>0.01932</td>
      <td>0.03029</td>
      <td>0.03446</td>
      <td>0.00261</td>
      <td>0.00157</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>virus</td>
      <td>0</td>
      <td>100887</td>
      <td>10.035918</td>
      <td>Soil-borne cereal mosaic virus</td>
      <td>0.02816</td>
      <td>0.01371</td>
      <td>0.00767</td>
      <td>0.03679</td>
      <td>0.01380</td>
      <td>...</td>
      <td>0.00604</td>
      <td>0.01494</td>
      <td>0.01734</td>
      <td>0.04148</td>
      <td>0.02483</td>
      <td>0.03359</td>
      <td>0.03679</td>
      <td>0.00000</td>
      <td>0.00044</td>
      <td>0.00131</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13023</th>
      <td>vertebrate</td>
      <td>0</td>
      <td>9601</td>
      <td>7.001246</td>
      <td>Pongo pygmaeus abelii</td>
      <td>0.02552</td>
      <td>0.03555</td>
      <td>0.00547</td>
      <td>0.01367</td>
      <td>0.01276</td>
      <td>...</td>
      <td>0.00820</td>
      <td>0.01367</td>
      <td>0.01094</td>
      <td>0.01367</td>
      <td>0.02279</td>
      <td>0.02005</td>
      <td>0.04102</td>
      <td>0.00091</td>
      <td>0.00091</td>
      <td>0.00638</td>
    </tr>
    <tr>
      <th>13024</th>
      <td>vertebrate</td>
      <td>1</td>
      <td>9601</td>
      <td>7.634337</td>
      <td>mitochondrion Pongo pygmaeus abelii</td>
      <td>0.01258</td>
      <td>0.03193</td>
      <td>0.01984</td>
      <td>0.00629</td>
      <td>0.01451</td>
      <td>...</td>
      <td>0.00145</td>
      <td>0.00000</td>
      <td>0.00048</td>
      <td>0.00194</td>
      <td>0.01306</td>
      <td>0.01838</td>
      <td>0.00677</td>
      <td>0.00242</td>
      <td>0.00097</td>
      <td>0.01887</td>
    </tr>
    <tr>
      <th>13025</th>
      <td>vertebrate</td>
      <td>1</td>
      <td>9602</td>
      <td>7.430707</td>
      <td>mitochondrion Pongo pygmaeus pygmaeus</td>
      <td>0.01423</td>
      <td>0.03321</td>
      <td>0.01661</td>
      <td>0.00356</td>
      <td>0.01127</td>
      <td>...</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.00178</td>
      <td>0.01661</td>
      <td>0.02788</td>
      <td>0.00297</td>
      <td>0.00356</td>
      <td>0.00119</td>
      <td>0.02017</td>
    </tr>
    <tr>
      <th>13026</th>
      <td>vertebrate</td>
      <td>0</td>
      <td>9606</td>
      <td>17.520819</td>
      <td>Homo sapiens</td>
      <td>0.01757</td>
      <td>0.02028</td>
      <td>0.00767</td>
      <td>0.01293</td>
      <td>0.01319</td>
      <td>...</td>
      <td>0.01142</td>
      <td>0.01217</td>
      <td>0.01196</td>
      <td>0.02178</td>
      <td>0.02510</td>
      <td>0.02896</td>
      <td>0.03959</td>
      <td>0.00099</td>
      <td>0.00079</td>
      <td>0.00156</td>
    </tr>
    <tr>
      <th>13027</th>
      <td>vertebrate</td>
      <td>1</td>
      <td>9606</td>
      <td>16.012624</td>
      <td>mitochondrion Homo sapiens</td>
      <td>0.01778</td>
      <td>0.03724</td>
      <td>0.01732</td>
      <td>0.00600</td>
      <td>0.01689</td>
      <td>...</td>
      <td>0.00083</td>
      <td>0.00041</td>
      <td>0.00041</td>
      <td>0.00451</td>
      <td>0.01402</td>
      <td>0.01651</td>
      <td>0.00783</td>
      <td>0.00156</td>
      <td>0.00114</td>
      <td>0.02161</td>
    </tr>
  </tbody>
</table>
<p>12964 rows × 69 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>codon.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>(12964, 69)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>codon[<span class="st">'Kingdom'</span>].value_counts().plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-8-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>codon[<span class="st">'DNAtype'</span>].value_counts().plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-9-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>codon.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>DNAtype</th>
      <th>SpeciesID</th>
      <th>Ncodons</th>
      <th>UUU</th>
      <th>UUC</th>
      <th>UUA</th>
      <th>UUG</th>
      <th>CUU</th>
      <th>CUC</th>
      <th>CUA</th>
      <th>...</th>
      <th>CGG</th>
      <th>AGA</th>
      <th>AGG</th>
      <th>GAU</th>
      <th>GAC</th>
      <th>GAA</th>
      <th>GAG</th>
      <th>UAA</th>
      <th>UAG</th>
      <th>UGA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>...</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
      <td>12964.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.349506</td>
      <td>130573.312635</td>
      <td>8.513725</td>
      <td>0.024712</td>
      <td>0.023460</td>
      <td>0.020553</td>
      <td>0.014084</td>
      <td>0.017822</td>
      <td>0.018338</td>
      <td>0.019082</td>
      <td>...</td>
      <td>0.005441</td>
      <td>0.009918</td>
      <td>0.006431</td>
      <td>0.024155</td>
      <td>0.021198</td>
      <td>0.028260</td>
      <td>0.021707</td>
      <td>0.001640</td>
      <td>0.000591</td>
      <td>0.006201</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.594362</td>
      <td>124773.296344</td>
      <td>1.647012</td>
      <td>0.017437</td>
      <td>0.011608</td>
      <td>0.020605</td>
      <td>0.009264</td>
      <td>0.010602</td>
      <td>0.014580</td>
      <td>0.024299</td>
      <td>...</td>
      <td>0.006603</td>
      <td>0.008575</td>
      <td>0.006399</td>
      <td>0.013844</td>
      <td>0.013033</td>
      <td>0.014348</td>
      <td>0.015024</td>
      <td>0.001788</td>
      <td>0.000883</td>
      <td>0.010363</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>7.000000</td>
      <td>6.908755</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>28897.000000</td>
      <td>7.382591</td>
      <td>0.013910</td>
      <td>0.015397</td>
      <td>0.005600</td>
      <td>0.007090</td>
      <td>0.010880</td>
      <td>0.007860</td>
      <td>0.005310</td>
      <td>...</td>
      <td>0.001220</td>
      <td>0.001678</td>
      <td>0.001160</td>
      <td>0.012307</td>
      <td>0.011890</td>
      <td>0.017340</td>
      <td>0.009747</td>
      <td>0.000560</td>
      <td>0.000000</td>
      <td>0.000410</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>82005.000000</td>
      <td>7.984803</td>
      <td>0.021720</td>
      <td>0.021920</td>
      <td>0.015225</td>
      <td>0.013345</td>
      <td>0.016130</td>
      <td>0.014600</td>
      <td>0.009690</td>
      <td>...</td>
      <td>0.003520</td>
      <td>0.009260</td>
      <td>0.004550</td>
      <td>0.025365</td>
      <td>0.019105</td>
      <td>0.026035</td>
      <td>0.020585</td>
      <td>0.001370</td>
      <td>0.000420</td>
      <td>0.001130</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.000000</td>
      <td>223048.250000</td>
      <td>9.117731</td>
      <td>0.031232</td>
      <td>0.029250</td>
      <td>0.029370</td>
      <td>0.019790</td>
      <td>0.022730</td>
      <td>0.025160</td>
      <td>0.017212</td>
      <td>...</td>
      <td>0.007110</td>
      <td>0.015893</td>
      <td>0.010300</td>
      <td>0.034200</td>
      <td>0.027692</td>
      <td>0.036790</td>
      <td>0.031160</td>
      <td>0.002370</td>
      <td>0.000830</td>
      <td>0.002920</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.000000</td>
      <td>465364.000000</td>
      <td>17.520819</td>
      <td>0.217300</td>
      <td>0.091690</td>
      <td>0.151330</td>
      <td>0.101190</td>
      <td>0.089780</td>
      <td>0.100350</td>
      <td>0.163920</td>
      <td>...</td>
      <td>0.055540</td>
      <td>0.098830</td>
      <td>0.058430</td>
      <td>0.185660</td>
      <td>0.113840</td>
      <td>0.144890</td>
      <td>0.158550</td>
      <td>0.045200</td>
      <td>0.025610</td>
      <td>0.106700</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 67 columns</p>
</div>
</div>
</div>
<hr>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assigning the target and features y and X</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> codon.drop(columns<span class="op">=</span>[<span class="st">'Kingdom'</span>, <span class="st">'DNAtype'</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">'SpeciesName'</span>, <span class="st">'SpeciesID'</span>])  <span class="co"># features</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> codon[<span class="st">'DNAtype'</span>]  <span class="co"># target</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    X, y, stratify<span class="op">=</span>y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># X_train, X_val, y_train, y_val = train_test_split(X_train, y_train, stratify = y_train, test_size= 0.25, random_state=123)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="vanilla-models" class="level1">
<h1>Vanilla Models:</h1>
<p>Plan:</p>
<ul>
<li>Pipeline for kNearest Neighbors, Logistic Regression, Decision Tree</li>
<li>Gridsearch and score comparison of the models</li>
</ul>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vanilla models pipeline</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>estimators <span class="op">=</span> [(<span class="st">'scaler'</span>, StandardScaler()), (<span class="st">'model'</span>, KNeighborsClassifier())]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>pipe <span class="op">=</span> Pipeline(estimators)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> [{<span class="st">'model'</span>: [KNeighborsClassifier()],</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">'scaler'</span>: [StandardScaler(), MinMaxScaler()]},</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>              {<span class="st">'model'</span>: [LogisticRegression(random_state<span class="op">=</span><span class="dv">123</span>, max_iter<span class="op">=</span><span class="dv">10000</span>)],</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">'scaler'</span>: [StandardScaler(), MinMaxScaler(), <span class="va">None</span>]},</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>              {<span class="st">'model'</span>: [DecisionTreeClassifier()],</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">'scaler'</span>: [<span class="va">None</span>]}]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gridsearch for vanilla</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>gridsearch <span class="op">=</span> GridSearchCV(pipe, parameters, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fit to train data</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>fittedgrid <span class="op">=</span> gridsearch.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>dna0_results_df <span class="op">=</span> pd.DataFrame.from_dict(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    gridsearch.cv_results_, orient<span class="op">=</span><span class="st">'columns'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>dna0_results_df.sort_values(by<span class="op">=</span><span class="st">'mean_test_score'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>mean_fit_time</th>
      <th>std_fit_time</th>
      <th>mean_score_time</th>
      <th>std_score_time</th>
      <th>param_model</th>
      <th>param_scaler</th>
      <th>params</th>
      <th>split0_test_score</th>
      <th>split1_test_score</th>
      <th>split2_test_score</th>
      <th>split3_test_score</th>
      <th>split4_test_score</th>
      <th>mean_test_score</th>
      <th>std_test_score</th>
      <th>rank_test_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.007935</td>
      <td>0.000073</td>
      <td>0.062146</td>
      <td>0.000578</td>
      <td>KNeighborsClassifier()</td>
      <td>MinMaxScaler()</td>
      <td>{'model': KNeighborsClassifier(), 'scaler': Mi...</td>
      <td>0.992771</td>
      <td>0.995661</td>
      <td>0.994214</td>
      <td>0.992768</td>
      <td>0.991803</td>
      <td>0.993443</td>
      <td>0.001350</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.010356</td>
      <td>0.000246</td>
      <td>0.068231</td>
      <td>0.006520</td>
      <td>KNeighborsClassifier()</td>
      <td>StandardScaler()</td>
      <td>{'model': KNeighborsClassifier(), 'scaler': St...</td>
      <td>0.993253</td>
      <td>0.994214</td>
      <td>0.992768</td>
      <td>0.993732</td>
      <td>0.992768</td>
      <td>0.993347</td>
      <td>0.000562</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.128971</td>
      <td>0.023637</td>
      <td>0.001845</td>
      <td>0.000116</td>
      <td>LogisticRegression(max_iter=10000, random_stat...</td>
      <td>StandardScaler()</td>
      <td>{'model': LogisticRegression(max_iter=10000, r...</td>
      <td>0.992771</td>
      <td>0.993732</td>
      <td>0.994214</td>
      <td>0.993250</td>
      <td>0.992285</td>
      <td>0.993250</td>
      <td>0.000681</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.068574</td>
      <td>0.003267</td>
      <td>0.001754</td>
      <td>0.000074</td>
      <td>LogisticRegression(max_iter=10000, random_stat...</td>
      <td>MinMaxScaler()</td>
      <td>{'model': LogisticRegression(max_iter=10000, r...</td>
      <td>0.991807</td>
      <td>0.990839</td>
      <td>0.989392</td>
      <td>0.991321</td>
      <td>0.986982</td>
      <td>0.990068</td>
      <td>0.001742</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.361713</td>
      <td>0.032015</td>
      <td>0.001524</td>
      <td>0.000075</td>
      <td>DecisionTreeClassifier()</td>
      <td>None</td>
      <td>{'model': DecisionTreeClassifier(), 'scaler': ...</td>
      <td>0.980241</td>
      <td>0.980714</td>
      <td>0.975410</td>
      <td>0.975892</td>
      <td>0.977338</td>
      <td>0.977919</td>
      <td>0.002188</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.142138</td>
      <td>0.024120</td>
      <td>0.001372</td>
      <td>0.000056</td>
      <td>LogisticRegression(max_iter=10000, random_stat...</td>
      <td>None</td>
      <td>{'model': LogisticRegression(max_iter=10000, r...</td>
      <td>0.952771</td>
      <td>0.948409</td>
      <td>0.946962</td>
      <td>0.945516</td>
      <td>0.945998</td>
      <td>0.947931</td>
      <td>0.002614</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression">Logistic Regression:</h2>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using SMOTE to balance the classes:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>sm <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>X_train_sm, y_train_sm <span class="op">=</span> sm.fit_resample(X_train, y_train)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting distributions</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Distributions before and after SMOTE upsampling:'</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">3</span>))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the original data</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>plt.bar(y_train.value_counts().index, y_train.value_counts())</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Original target classes'</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the upsampled data</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>plt.bar(y_train_sm.value_counts().index, y_train_sm.value_counts())</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Upsampled target classes'</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=============================================================================='</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># scaling data for PCA tranform</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="op">=</span> scaler.fit_transform(X_train_sm)  <span class="co"># scaling the upsampled set</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="op">=</span> scaler.transform(X_test)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA dimensionality reduction</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA()</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co"># fit transform train set and transform test set</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>X_train_PCA <span class="op">=</span> pca.fit_transform(X_train_scaled)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>X_test_PCA <span class="op">=</span> pca.transform(X_test_scaled)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># to see the number of features that account for the highest variance</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>explained_variance <span class="op">=</span> pca.explained_variance_ratio_</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co"># cumulative sum of the explained variance</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>cumulative_sum <span class="op">=</span> np.cumsum(explained_variance)</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"darkgrid"</span>)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(X_train.columns)<span class="op">+</span><span class="dv">1</span>), cumulative_sum, marker<span class="op">=</span><span class="st">'.'</span>)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="fl">0.9</span>, c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Number of PCs'</span>)</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Cumulative Sum of Explained Variance'</span>)</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>plt.xticks(<span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(X_train.columns)<span class="op">+</span><span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"How many features explain 90</span><span class="sc">% o</span><span class="st">f total variance"</span>)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Distributions before and after SMOTE upsampling:</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>==============================================================================</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-15-output-4.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setting n_components and refitting a PCA</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>pca_0 <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">26</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit transform train set and transform test set</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>X_train_PCA_0 <span class="op">=</span> pca_0.fit_transform(X_train_scaled)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>X_test_PCA_0 <span class="op">=</span> pca_0.transform(X_test_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regularisation:</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>c_params <span class="op">=</span> [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>]</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>train_accuracies <span class="op">=</span> []</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>test_accuracies <span class="op">=</span> []</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> c_params:</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    logi_reg <span class="op">=</span> LogisticRegression(C<span class="op">=</span>c, max_iter<span class="op">=</span><span class="dv">10000</span>, random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    logi_reg.fit(X_train_PCA_0, y_train_sm)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    train_accuracies.append(logi_reg.score(X_train_PCA_0, y_train_sm))</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    test_accuracies.append(logi_reg.score(X_test_PCA_0, y_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"darkgrid"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>plt.plot(c_params, train_accuracies, label<span class="op">=</span><span class="st">'train'</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>plt.plot(c_params, test_accuracies, label<span class="op">=</span><span class="st">'test'</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>plt.xscale(<span class="st">'log'</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Accuracies for logi_reg model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>Text(0.5, 1.0, 'Accuracies for logi_reg model')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For C =0.1</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>log_reg_0 <span class="op">=</span> LogisticRegression(C<span class="op">=</span><span class="fl">0.1</span>, max_iter<span class="op">=</span><span class="dv">10000</span>, random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>log_reg_0.fit(X_train_PCA_0, y_train_sm)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f'log_reg_0 model train score: </span><span class="sc">{</span>log_reg_0<span class="sc">.</span>score(X_train_PCA_0, y_train_sm)<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f'log_reg_0 model test score: </span><span class="sc">{</span>log_reg_0<span class="sc">.</span>score(X_test_PCA_0, y_test)<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>log_reg_0 model train score: 0.99
log_reg_0 model test score: 0.985</code></pre>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>y_predicted <span class="op">=</span> log_reg_0.predict(X_test_PCA_0)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate confusion matrix</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>cf_matrix <span class="op">=</span> confusion_matrix(y_test, y_predicted)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># label rows and columns</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>cf_df <span class="op">=</span> pd.DataFrame(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    cf_matrix,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">"Predicted 0"</span>, <span class="st">"Predicted 1"</span>, <span class="st">"Predicted 2"</span>],</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"True 0"</span>, <span class="st">"True 1"</span>, <span class="st">"True 2"</span>])</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"dark"</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(log_reg_0, X_test_PCA_0, y_test)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision, recall, and F1 score:</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>class_report_log_0 <span class="op">=</span> classification_report(y_test, y_predicted)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(class_report_log_0)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co"># AUC score</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>y_proba_train <span class="op">=</span> log_reg_0.predict_proba(X_train_PCA_0)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>auc_train <span class="op">=</span> np.<span class="bu">round</span>(roc_auc_score(</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    y_train_sm, y_proba_train, multi_class<span class="op">=</span><span class="st">'ovo'</span>), <span class="dv">3</span>)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Logistic Regression model AUC score'</span>)</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'roc_auc_score: </span><span class="sc">{</span>auc_train<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>cf_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==========================================================
              precision    recall  f1-score   support

           0       1.00      0.99      0.99      1850
           1       0.98      0.98      0.98       580
           2       0.88      0.96      0.92       163

    accuracy                           0.98      2593
   macro avg       0.95      0.98      0.96      2593
weighted avg       0.99      0.98      0.98      2593

==========================================================
Logistic Regression model AUC score
roc_auc_score: 1.0
==========================================================</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/amina/anaconda3/envs/plotly_bokeh/lib/python3.8/site-packages/sklearn/utils/deprecation.py:87: FutureWarning: Function plot_confusion_matrix is deprecated; Function `plot_confusion_matrix` is deprecated in 1.0 and will be removed in 1.2. Use one of the class methods: ConfusionMatrixDisplay.from_predictions or ConfusionMatrixDisplay.from_estimator.
  warnings.warn(msg, category=FutureWarning)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="69">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Predicted 0</th>
      <th>Predicted 1</th>
      <th>Predicted 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>True 0</th>
      <td>1828</td>
      <td>8</td>
      <td>14</td>
    </tr>
    <tr>
      <th>True 1</th>
      <td>4</td>
      <td>569</td>
      <td>7</td>
    </tr>
    <tr>
      <th>True 2</th>
      <td>4</td>
      <td>3</td>
      <td>156</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-20-output-4.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li><strong>Interpreting Results for Logistic Regression</strong></li>
</ul>
<p>Logistic Regression model classifies using a logistic function, where the output is either 1 or 0, this is usually for binomial classification. I balanced the classes using SMOTE, and then performed a PCA fit on the train and transformed the test set. PCA reduces dimensionality to reduce overfitting, and use fewer features from the dataset. According to the graph above, the number of number of components needed to explain 90% of the variance is 29.</p>
<p>The Logistic Regression model <code>log_reg_0</code> has performed well on the dataset with an accuracy score of 0.99 on training data and 0.985 on the test data.</p>
<p>Furthermore, hyperparameter tuning showed that a high penalty of C=0.1 was the appropriate value to achieve a higher accuracy score.</p>
<p>The model performed well on classifying the DNA types, with an F1 score of 0.99, 0.98, and 0.89 for types 0 (nuclear), 1 (mitochondrial), and 2(chloroplast) respectively. This shows that the model has equivently good precision and recall, meaning that the model classified the classes correctly the majority of time with low percentage of false positives overall.</p>
<p>The AUC score of 0.999 shows that the model performed well overall at distinguishing between the classes.</p>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualising the PCA components in a scatter graph</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> plt.scatter(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    X_train_PCA_0[:, <span class="dv">0</span>], X_train_PCA_0[:, <span class="dv">1</span>], alpha<span class="op">=</span><span class="fl">0.3</span>, c<span class="op">=</span>y_train_sm)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Principal Component 1"</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Principal Component 2"</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>classes <span class="op">=</span> [<span class="st">'0: nuclear DNA'</span>, <span class="st">'1: mitochondrial DNA'</span>, <span class="st">'2: chloroplast DNA'</span>]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>plt.legend(handles<span class="op">=</span>scatter.legend_elements()[<span class="dv">0</span>], labels<span class="op">=</span>classes)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The principal components analysis of the features shows good separation between the <code>DNAtype</code> classes, this could be why the logistic regression is performing well on this dataset,</p>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature importance</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>coefs <span class="op">=</span> pd.DataFrame(log_reg_0.coef_[<span class="dv">0</span>], columns<span class="op">=</span>[<span class="st">'coefficients'</span>])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>coefs</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>feat_names <span class="op">=</span> pd.DataFrame(X_train.columns, columns<span class="op">=</span>[<span class="st">'feature_names'</span>])</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>feat_names</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>feat_coefs <span class="op">=</span> pd.concat([feat_names, coefs], axis<span class="op">=</span><span class="dv">1</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>feat_coefs <span class="op">=</span> feat_coefs.sort_values(</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span><span class="dv">1</span>, ascending<span class="op">=</span><span class="va">False</span>).set_index(<span class="dv">0</span>).head(<span class="dv">26</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting coefficients</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"darkgrid"</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>plt.bar(feat_coefs.index, feat_coefs[<span class="dv">1</span>])</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Logistic Regression adds coefficients (beta1) to each feature, the above bar chart shows the coefficients for the 26 features for the <code>0: nuclear</code>. the coefficients represent the log odds of a feature change effecting the outcome.</p>
<p>for the <code>log_reg_0</code> model, the above barchart shows that with increase frequency of <code>UUU</code> and <code>UUG</code> for example, there is an increased odds of <code>0: nuclear</code> classification. The bar grapgh shows how the model made the decision of classification, in terms of these features.</p>
<p><code>Ncodons</code> appears to be a feature with a positive and high coefficient for the nuclear DNA (0) class, this makes sense because Ncodons represents the size of the sequence, nuclear DNA is the larger of the DNAtypes so the number of codons would reflect this.</p>
</section>
<section id="knearest-neighbors-model" class="level2">
<h2 class="anchored" data-anchor-id="knearest-neighbors-model">kNearest Neighbors model:</h2>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using the already scaled and PCA tranformed sets from previous model</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Determining the ideal n_neighbors value:</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>n_neighbors <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>train_accuracies_0 <span class="op">=</span> []</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>test_accuracies_0 <span class="op">=</span> []</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> n_neighbors:</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    KNN_model <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>n)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    KNN_model.fit(X_train_PCA_0, y_train_sm)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    train_accuracies_0.append(KNN_model.score(X_train_PCA_0, y_train_sm))</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    test_accuracies_0.append(KNN_model.score(X_test_PCA_0, y_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>plt.plot(n_neighbors, train_accuracies_0, label<span class="op">=</span><span class="st">'train'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>plt.plot(n_neighbors, test_accuracies_0, label<span class="op">=</span><span class="st">'test'</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Accuracies for KNN_model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>Text(0.5, 1.0, 'Accuracies for KNN_model')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-24-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Knn_accuracies_df <span class="op">=</span> pd.DataFrame({<span class="st">'number of neighbors'</span>: n_neighbors,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">'Train scores'</span>: train_accuracies_0, <span class="st">'Test scores'</span>: test_accuracies_0})</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>Knn_accuracies_df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>number of neighbors</th>
      <th>Train scores</th>
      <th>Test scores</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1.000000</td>
      <td>0.993444</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>0.999054</td>
      <td>0.992673</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>0.997883</td>
      <td>0.993444</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>0.996711</td>
      <td>0.990359</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>0.996171</td>
      <td>0.989202</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>KNN_model_0 <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>KNN_model_0.fit(X_train_PCA_0, y_train_sm)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f'KNN_model train score: </span><span class="sc">{</span>KNN_model_0<span class="sc">.</span>score(X_train_PCA_0, y_train_sm)<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f'KNN_model test score: </span><span class="sc">{</span>KNN_model_0<span class="sc">.</span>score(X_test_PCA_0, y_test)<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>KNN_model train score: 0.999
KNN_model test score: 0.993</code></pre>
</div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>y_predicted_0 <span class="op">=</span> KNN_model_0.predict(X_test_PCA_0)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate confusion matrix</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>cf_matrix_0 <span class="op">=</span> confusion_matrix(y_test, y_predicted_0)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># label rows and columns</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>cf_df_0 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    cf_matrix_0,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">"Predicted 0"</span>, <span class="st">"Predicted 1"</span>, <span class="st">"Predicted 2"</span>],</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"True 0"</span>, <span class="st">"True 1"</span>, <span class="st">"True 2"</span>])</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"dark"</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(KNN_model_0, X_test_PCA_0, y_test)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision, recall, and F1 scores</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>class_report_knn_0 <span class="op">=</span> classification_report(y_test, y_predicted_0)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(class_report_knn_0)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="co"># AUC score</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>y_proba_train_0 <span class="op">=</span> KNN_model_0.predict_proba(X_train_PCA_0)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>auc_train_0 <span class="op">=</span> np.<span class="bu">round</span>(roc_auc_score(</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    y_train_sm, y_proba_train_0, multi_class<span class="op">=</span><span class="st">'ovo'</span>), <span class="dv">3</span>)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'KNN model AUC score'</span>)</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'roc_auc_score: </span><span class="sc">{</span>auc_train_0<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>cf_df_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==========================================================
              precision    recall  f1-score   support

           0       1.00      0.99      1.00      1850
           1       0.99      0.99      0.99       580
           2       0.96      0.99      0.97       163

    accuracy                           0.99      2593
   macro avg       0.98      0.99      0.99      2593
weighted avg       0.99      0.99      0.99      2593

==========================================================</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/amina/anaconda3/envs/plotly_bokeh/lib/python3.8/site-packages/sklearn/utils/deprecation.py:87: FutureWarning: Function plot_confusion_matrix is deprecated; Function `plot_confusion_matrix` is deprecated in 1.0 and will be removed in 1.2. Use one of the class methods: ConfusionMatrixDisplay.from_predictions or ConfusionMatrixDisplay.from_estimator.
  warnings.warn(msg, category=FutureWarning)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>KNN model AUC score
roc_auc_score: 1.0
==========================================================</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="76">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Predicted 0</th>
      <th>Predicted 1</th>
      <th>Predicted 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>True 0</th>
      <td>1839</td>
      <td>7</td>
      <td>4</td>
    </tr>
    <tr>
      <th>True 1</th>
      <td>3</td>
      <td>574</td>
      <td>3</td>
    </tr>
    <tr>
      <th>True 2</th>
      <td>1</td>
      <td>1</td>
      <td>161</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-27-output-5.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li><strong>Interpreting Results for kNearest Neighbors</strong>:</li>
</ul>
<p>kNearest Neighbor model classifies by determining the distances between the data points: data points closest to each other are classified as being from the same class, depending on the number of nearest neighbors selected. Because KNN usese distances between data points, I scaled the data performed PCA and used the SMOTE transformed data.</p>
<p>The KNN_model_0 performed very well, with an accuracy score of 0.999 for the training data and 0.993 for the test data, for a value of n_neighbors = 3.</p>
<p>The model performed well on all of the classes, with improvement in the precision and recall scores: F1 scores of 1.0, 0.99, and 0.97 for 0 (nuclear), 1 (mitochondrial), and 2 (chloroplast) respectively.</p>
<p>Overall the KNN_model_0 performed well on distinguising between the classes with an AUC score of 1.0.</p>
</section>
<section id="xgboost-model" class="level2">
<h2 class="anchored" data-anchor-id="xgboost-model">XGBoost model:</h2>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>maxdepth <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>train_accuracies_1 <span class="op">=</span> []</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>test_accuracies_1 <span class="op">=</span> []</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> d <span class="kw">in</span> maxdepth:</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    XGB_model <span class="op">=</span> XGBClassifier(max_depth<span class="op">=</span>d, use_label_encoder<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    XGB_model.fit(X_train, y_train)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    train_accuracies_1.append(XGB_model.score(X_train, y_train))</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    test_accuracies_1.append(XGB_model.score(X_test, y_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>plt.plot(maxdepth, train_accuracies_1, label<span class="op">=</span><span class="st">'train'</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>plt.plot(maxdepth, test_accuracies_1, label<span class="op">=</span><span class="st">'test'</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Accuracies for XGBoost model'</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>XGB_accuracies_df <span class="op">=</span> pd.DataFrame(</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'max Depth'</span>: maxdepth, <span class="st">'Train scores'</span>: train_accuracies_1, <span class="st">'Test scores'</span>: test_accuracies_1})</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>XGB_accuracies_df.sort_values(by<span class="op">=</span><span class="st">'Test scores'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>max Depth</th>
      <th>Train scores</th>
      <th>Test scores</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1.000000</td>
      <td>0.994601</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1.000000</td>
      <td>0.994601</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>1.000000</td>
      <td>0.994601</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>1.000000</td>
      <td>0.994601</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>1.000000</td>
      <td>0.994601</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1.000000</td>
      <td>0.994215</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.999807</td>
      <td>0.993444</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>1.000000</td>
      <td>0.993444</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.995565</td>
      <td>0.991516</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-29-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># XGBoost with max+depth = 3</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>XGB_model_0 <span class="op">=</span> XGBClassifier(max_depth<span class="op">=</span><span class="dv">3</span>, use_label_encoder<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>XGB_model_0.fit(X_train, y_train)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f'XGBoost train accuracy: </span><span class="sc">{</span>XGB_model_0<span class="sc">.</span>score(X_train, y_train)<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'XGBoost test accuracy: </span><span class="sc">{</span>XGB_model_0<span class="sc">.</span>score(X_test, y_test)<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>XGBoost train accuracy: 1.0
XGBoost test accuracy: 0.995</code></pre>
</div>
</div>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>y_predicted_1 <span class="op">=</span> XGB_model_0.predict(X_test)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate confusion matrix</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>cf_matrix_1 <span class="op">=</span> confusion_matrix(y_test, y_predicted_1)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># label rows and columns</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>cf_df_1 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    cf_matrix_1,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">"Predicted 0"</span>, <span class="st">"Predicted 1"</span>, <span class="st">"Predicted 2"</span>],</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"True 0"</span>, <span class="st">"True 1"</span>, <span class="st">"True 2"</span>])</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"dark"</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(XGB_model, X_test, y_test)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision Recall and F1 scores</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>class_report_xgb_0 <span class="op">=</span> classification_report(y_test, y_predicted_1)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(class_report_xgb_0)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="co"># AUC score</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>y_proba_train_1 <span class="op">=</span> XGB_model_0.predict_proba(X_train)</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>auc_train_1 <span class="op">=</span> np.<span class="bu">round</span>(roc_auc_score(</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>    y_train, y_proba_train_1, multi_class<span class="op">=</span><span class="st">'ovo'</span>), <span class="dv">3</span>)</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'XGBoost model AUC score'</span>)</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'roc_auc_score: </span><span class="sc">{</span>auc_train_1<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>cf_df_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==========================================================
              precision    recall  f1-score   support

           0       1.00      1.00      1.00      1850
           1       0.99      0.99      0.99       580
           2       0.99      0.96      0.97       163

    accuracy                           0.99      2593
   macro avg       0.99      0.98      0.99      2593
weighted avg       0.99      0.99      0.99      2593

==========================================================
XGBoost model AUC score
roc_auc_score: 1.0
==========================================================</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/amina/anaconda3/envs/plotly_bokeh/lib/python3.8/site-packages/sklearn/utils/deprecation.py:87: FutureWarning: Function plot_confusion_matrix is deprecated; Function `plot_confusion_matrix` is deprecated in 1.0 and will be removed in 1.2. Use one of the class methods: ConfusionMatrixDisplay.from_predictions or ConfusionMatrixDisplay.from_estimator.
  warnings.warn(msg, category=FutureWarning)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="80">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Predicted 0</th>
      <th>Predicted 1</th>
      <th>Predicted 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>True 0</th>
      <td>1848</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>True 1</th>
      <td>4</td>
      <td>575</td>
      <td>1</td>
    </tr>
    <tr>
      <th>True 2</th>
      <td>5</td>
      <td>2</td>
      <td>156</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-31-output-4.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li><strong>Interpreting Results for XGBoost model</strong>:</li>
</ul>
<p>XGBoost model is an ensemble model, it classifies data using decision trees in ensembles. Using max_depth as the hyperparameter, which determines the maximium depth of the trees. I did not use the scaled, oversamples, and PCA transformed data for this model, as this is not needed.</p>
<p>For XGB_model_0 the appropriate value for max_depth was determined to be 3, this gave an accuracy score of 1.0 for training data and 0.995 for test data. The model did not overfit on the training data, the model is performing just as well on the training data and on unseen data (test set).</p>
<p>The model performed very well on the data, showing high F1 scores, identical to the KNN_model_0, which shows that the use of two different classification models with different approaches are able to classify the target data really well.</p>
<p>Furthermore, this model performed well on distinguishing between the classes with an AUC score of 1.0.</p>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>feat_imprt <span class="op">=</span> pd.DataFrame(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    XGB_model_0.feature_importances_).sort_values(by<span class="op">=</span><span class="dv">0</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>feat_names_0 <span class="op">=</span> pd.DataFrame(X_train.columns, columns<span class="op">=</span>[<span class="st">'feature_names'</span>])</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># join inner because the ndarray lengths are different</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>feat_coefs_0 <span class="op">=</span> pd.concat([feat_names_0, feat_imprt],</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                         axis<span class="op">=</span><span class="dv">1</span>, ignore_index<span class="op">=</span><span class="va">True</span>, join<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>feat_coefs_0 <span class="op">=</span> feat_coefs_0.sort_values(</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span><span class="dv">1</span>, ascending<span class="op">=</span><span class="va">False</span>).set_index(<span class="dv">0</span>).head(<span class="dv">20</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting coefficients</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"darkgrid"</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>plt.bar(feat_coefs_0.index, feat_imprt[<span class="dv">0</span>][:<span class="dv">20</span>])</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Feature importance for XGBoost models shows the features that the model deemed most important in making the classification decision.</p>
<p>the above bar chart shows the codons importance according to <code>gain</code> metric, which is the relative contribution of each feature for each tree in the ensemble (XGBoost) model. This means that <code>UGA</code> having the highest values of importance were the most important in generating a prediction of the outcome classification.</p>
</section>
<section id="ensemble-model" class="level2">
<h2 class="anchored" data-anchor-id="ensemble-model">Ensemble Model</h2>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We instantiate the base models, along with their names</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>base_models <span class="op">=</span> [(<span class="st">'KNN'</span>, KNN_model_0),</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>               (<span class="st">'XGBoost'</span>, XGB_model_0)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>               ]</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># building the stacked model</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>stacked_model <span class="op">=</span> StackingClassifier(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    estimators<span class="op">=</span>base_models,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    final_estimator<span class="op">=</span>LogisticRegression(random_state<span class="op">=</span><span class="dv">123</span>, max_iter<span class="op">=</span><span class="dv">10000</span>),</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    passthrough<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>stacked_model.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>StackingClassifier(estimators=[('KNN', KNeighborsClassifier(n_neighbors=3)),
                               ('XGBoost',
                                XGBClassifier(base_score=0.5, booster='gbtree',
                                              callbacks=None,
                                              colsample_bylevel=1,
                                              colsample_bynode=1,
                                              colsample_bytree=1,
                                              early_stopping_rounds=None,
                                              enable_categorical=False,
                                              eval_metric=None, gamma=0,
                                              gpu_id=-1,
                                              grow_policy='depthwise',
                                              importance_type=None,
                                              interaction_c...
                                              learning_rate=0.300000012,
                                              max_bin=256, max_cat_to_onehot=4,
                                              max_delta_step=0, max_depth=3,
                                              max_leaves=0, min_child_weight=1,
                                              missing=nan,
                                              monotone_constraints='()',
                                              n_estimators=100, n_jobs=0,
                                              num_parallel_tree=1,
                                              objective='multi:softprob',
                                              predictor='auto', random_state=0,
                                              reg_alpha=0, ...))],
                   final_estimator=LogisticRegression(max_iter=10000,
                                                      random_state=123),
                   passthrough=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">StackingClassifier</label><div class="sk-toggleable__content"><pre>StackingClassifier(estimators=[('KNN', KNeighborsClassifier(n_neighbors=3)),
                               ('XGBoost',
                                XGBClassifier(base_score=0.5, booster='gbtree',
                                              callbacks=None,
                                              colsample_bylevel=1,
                                              colsample_bynode=1,
                                              colsample_bytree=1,
                                              early_stopping_rounds=None,
                                              enable_categorical=False,
                                              eval_metric=None, gamma=0,
                                              gpu_id=-1,
                                              grow_policy='depthwise',
                                              importance_type=None,
                                              interaction_c...
                                              learning_rate=0.300000012,
                                              max_bin=256, max_cat_to_onehot=4,
                                              max_delta_step=0, max_depth=3,
                                              max_leaves=0, min_child_weight=1,
                                              missing=nan,
                                              monotone_constraints='()',
                                              n_estimators=100, n_jobs=0,
                                              num_parallel_tree=1,
                                              objective='multi:softprob',
                                              predictor='auto', random_state=0,
                                              reg_alpha=0, ...))],
                   final_estimator=LogisticRegression(max_iter=10000,
                                                      random_state=123),
                   passthrough=True)</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><label>KNN</label></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsClassifier(n_neighbors=3)</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><label>XGBoost</label></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">XGBClassifier</label><div class="sk-toggleable__content"><pre>XGBClassifier(base_score=0.5, booster='gbtree', callbacks=None,
              colsample_bylevel=1, colsample_bynode=1, colsample_bytree=1,
              early_stopping_rounds=None, enable_categorical=False,
              eval_metric=None, gamma=0, gpu_id=-1, grow_policy='depthwise',
              importance_type=None, interaction_constraints='',
              learning_rate=0.300000012, max_bin=256, max_cat_to_onehot=4,
              max_delta_step=0, max_depth=3, max_leaves=0, min_child_weight=1,
              missing=nan, monotone_constraints='()', n_estimators=100,
              n_jobs=0, num_parallel_tree=1, objective='multi:softprob',
              predictor='auto', random_state=0, reg_alpha=0, ...)</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><label>final_estimator</label></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression(max_iter=10000, random_state=123)</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f'Stacked model train accuracy: </span><span class="sc">{</span>stacked_model<span class="sc">.</span>score(X_train, y_train)<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f'Stacked model test accuracy: </span><span class="sc">{</span>stacked_model<span class="sc">.</span>score(X_test, y_test)<span class="sc">.</span><span class="bu">round</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stacked model train accuracy: 1.0
Stacked model test accuracy: 0.995</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>y_predicted_2 <span class="op">=</span> stacked_model.predict(X_test)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate confusion matrix</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>cf_matrix_2 <span class="op">=</span> confusion_matrix(y_test, y_predicted_2)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># label rows and columns</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>cf_df_2 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    cf_matrix_2,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">"Predicted 0"</span>, <span class="st">"Predicted 1"</span>, <span class="st">"Predicted 2"</span>],</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>[<span class="st">"True 0"</span>, <span class="st">"True 1"</span>, <span class="st">"True 2"</span>])</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"dark"</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>plot_confusion_matrix(stacked_model, X_test, y_test)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision Recall and F1 scores</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>class_report_stack_0 <span class="op">=</span> classification_report(y_test, y_predicted_2)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(class_report_stack_0)</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="co"># AUC score</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>y_proba_train_2 <span class="op">=</span> stacked_model.predict_proba(X_train)</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>auc_train_2 <span class="op">=</span> np.<span class="bu">round</span>(roc_auc_score(</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>    y_train, y_proba_train_2, multi_class<span class="op">=</span><span class="st">'ovo'</span>), <span class="dv">3</span>)</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'AUC score for Stacked model'</span>)</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'roc_auc_score: </span><span class="sc">{</span>auc_train_2<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'=========================================================='</span>)</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>cf_df_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/amina/anaconda3/envs/plotly_bokeh/lib/python3.8/site-packages/sklearn/utils/deprecation.py:87: FutureWarning: Function plot_confusion_matrix is deprecated; Function `plot_confusion_matrix` is deprecated in 1.0 and will be removed in 1.2. Use one of the class methods: ConfusionMatrixDisplay.from_predictions or ConfusionMatrixDisplay.from_estimator.
  warnings.warn(msg, category=FutureWarning)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>==========================================================
              precision    recall  f1-score   support

           0       1.00      1.00      1.00      1850
           1       0.99      0.99      0.99       580
           2       0.99      0.96      0.97       163

    accuracy                           0.99      2593
   macro avg       0.99      0.98      0.99      2593
weighted avg       0.99      0.99      0.99      2593

==========================================================
AUC score for Stacked model
roc_auc_score: 1.0
==========================================================</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="43">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Predicted 0</th>
      <th>Predicted 1</th>
      <th>Predicted 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>True 0</th>
      <td>1848</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>True 1</th>
      <td>4</td>
      <td>575</td>
      <td>1</td>
    </tr>
    <tr>
      <th>True 2</th>
      <td>5</td>
      <td>2</td>
      <td>156</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell-output cell-output-display">
<p><img src="04-DnaType-Classification_files/figure-html/cell-35-output-4.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li><strong>Interpreting Results for the sctacked (ensemble) model</strong>:</li>
</ul>
<p>For the ensemble or stacked model, I used the models I already trained and tuned, with the exception of the logistic regression model <code>log_reg_0</code>; I decided to exclude this model as it was the model that underperformed on classifying the target variable.</p>
<p>I only included <code>XGB_model_0</code> and <code>KNN_model_0</code> as base models, with a final estimator being a default Logistic Regression model. Each of the base estimators is different in the way it approaches the classification.</p>
<p>The ensemble model classifies by taking the outputs from both the XGBoost model and KNN model as probabilites of each class as an input, the final estimator being a logistic regression then uses logistic function to classify each class.</p>
<p><code>stacked_model</code> achieved an accuracy score of 1.0 for the train data and 0.995 for the test data.</p>
<p>The stacked model did well in distinguishing between the classes with an AUC of 1.0.</p>
<hr>
</section>
<section id="comparing-models" class="level2">
<h2 class="anchored" data-anchor-id="comparing-models">Comparing Models</h2>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>cls <span class="op">=</span> classification_report(y_test, y_predicted, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>cls_0 <span class="op">=</span> classification_report(y_test, y_predicted_0, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>cls_1 <span class="op">=</span> classification_report(y_test, y_predicted_1, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>cls_2 <span class="op">=</span> classification_report(y_test, y_predicted_2, output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="op">=</span> pd.DataFrame({<span class="st">'Precision'</span>:</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>                             [cls[<span class="st">'weighted avg'</span>][<span class="st">'precision'</span>],</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                              cls_0[<span class="st">'weighted avg'</span>][<span class="st">'precision'</span>],</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                              cls_1[<span class="st">'weighted avg'</span>][<span class="st">'precision'</span>],</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                              cls_2[<span class="st">'weighted avg'</span>][<span class="st">'precision'</span>]],</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'Recall'</span>:</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                             [cls[<span class="st">'weighted avg'</span>][<span class="st">'recall'</span>],</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>                              cls_0[<span class="st">'weighted avg'</span>][<span class="st">'recall'</span>],</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>                              cls_1[<span class="st">'weighted avg'</span>][<span class="st">'recall'</span>],</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>                              cls_2[<span class="st">'weighted avg'</span>][<span class="st">'recall'</span>]],</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'F1 score'</span>:</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>                              [cls[<span class="st">'weighted avg'</span>][<span class="st">'f1-score'</span>],</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>                              cls_0[<span class="st">'weighted avg'</span>][<span class="st">'f1-score'</span>],</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>                               cls_1[<span class="st">'weighted avg'</span>][<span class="st">'f1-score'</span>],</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>                              cls_2[<span class="st">'weighted avg'</span>][<span class="st">'f1-score'</span>]],</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'Accuracy'</span>:</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>                              [cls[<span class="st">'accuracy'</span>],</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>                               cls_0[<span class="st">'accuracy'</span>],</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>                               cls_1[<span class="st">'accuracy'</span>],</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>                               cls_2[<span class="st">'accuracy'</span>]],</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'AUC score'</span>:</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>                              [auc_train,</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>                               auc_train_0,</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>                               auc_train_1,</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>                               auc_train_2]</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>                              },</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>                             index<span class="op">=</span>[<span class="st">'Logistic Regression'</span>, <span class="st">'kNearest Neighbors'</span>, <span class="st">'XGBoost'</span>, <span class="st">'Stacked model'</span>])</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>comparison_df.<span class="bu">round</span>(<span class="dv">3</span>).sort_values(by<span class="op">=</span><span class="st">'F1 score'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1 score</th>
      <th>Accuracy</th>
      <th>AUC score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>XGBoost</th>
      <td>0.995</td>
      <td>0.995</td>
      <td>0.995</td>
      <td>0.995</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Stacked model</th>
      <td>0.995</td>
      <td>0.995</td>
      <td>0.995</td>
      <td>0.995</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>kNearest Neighbors</th>
      <td>0.993</td>
      <td>0.993</td>
      <td>0.993</td>
      <td>0.993</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Logistic Regression</th>
      <td>0.985</td>
      <td>0.985</td>
      <td>0.985</td>
      <td>0.985</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>According to the <code>F1 score</code> XGBoost model and the Stacked model performed the best and similarly. This makes sense, contrary to the Kingdom classification, the DNAtype only has three classes, which means that the XGBoost would perform better in this classification as it can get a pure node easier.</p>
<p>Looking at the vanilla models performed at the beginning the accuracy score for the kNearest Neighbor performed was 99.3%, so I only achived an improvement of %0.2 for the <code>DNAtype</code> classses classification.</p>
<hr>
</section>
<section id="saving-models" class="level2">
<h2 class="anchored" data-anchor-id="saving-models">Saving Models:</h2>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic Regression model</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>log_reg_dna <span class="op">=</span> <span class="st">'finalized_log_reg_dna.sav'</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>joblib.dump(log_reg_0, log_reg_dna)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># kNearest Neighbor model</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>knn_dna <span class="op">=</span> <span class="st">'finalized_knn_dna.sav'</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>joblib.dump(KNN_model_0, knn_dna)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># XGBoost model</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>xgboost_dna <span class="op">=</span> <span class="st">'finalized_xgboost_dna.sav'</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>joblib.dump(XGB_model_0, xgboost_dna)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensemble model</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>stacked_dna <span class="op">=</span> <span class="st">'finalized_stacked_dna.sav'</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>joblib.dump(stacked_model, stacked_dna)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>['finalized_stacked_dna.sav']</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>